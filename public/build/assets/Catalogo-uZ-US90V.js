import{R as a,r as i}from"./FilterContainer-TykbAVkI.js";import{c as A}from"./ReactAppend-GBOQKLDe.js";import{C as q}from"./CreateReactScript-Il069F1S.js";import{F as C,P as O,a as D}from"./ProductCard-EMqdq8Z6.js";import"./SelectAPIFormGroup-A251JnnE.js";import{a as H}from"./arrayJoin-Fk5sgFcM.js";import{a as b}from"./axios-_sX4vCAy.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./index-GBzf7Cls.js";import"./CreateReactScript-Hm6EbMAE.js";import"./TippyButton-w0wM3ydO.js";const L=({minPrice:f,maxPrice:d,categories:g,tags:E,attribute_values:S,id_cat:n,tag_id:y,subCatId:w,banners:_})=>{const[R,M]=i.useState([]),[l,c]=i.useState({}),[p,T]=i.useState(0),[s,v]=i.useState(1),[B,k]=i.useState(!1),N=i.useRef(!1),x=i.useRef(null);i.useEffect(()=>{const e=document.createElement("script");return e.src="js/notify.extend.min.js",e.async=!0,document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]),i.useEffect(()=>{const t=new URLSearchParams(window.location.search).get("tag");t&&c(r=>({...r,"txp.tag_id":[t]})),n&&c(r=>({...r,category_id:[n]}))},[n]),i.useEffect(()=>{v(1),P()},[l]),i.useEffect(()=>{P()},[s]),i.useEffect(()=>{w!==null&&c({...l,subcategory_id:[w]})},[]);const P=async()=>{x.current&&x.current.cancel("Operation canceled due to new request."),x.current=b.CancelToken.source();const e=[];if((l.maxPrice||l.minPrice)&&(l.maxPrice&&l.minPrice?e.push([[["precio",">=",l.minPrice],"or",[["descuento",">=",l.minPrice],"and",["descuento","<>",0]]],"and",[["precio","<=",l.maxPrice],"or",[["descuento","<=",l.maxPrice],"and",["descuento","<>",0]]]]):l.minPrice?e.push([["precio",">=",l.minPrice],"or",[["descuento",">=",l.minPrice],"and",["descuento","<>",0]]]):l.maxPrice&&e.push([["precio","<=",l.maxPrice],"or",[["descuento","<=",l.maxPrice],"and",["descuento","<>",0]]])),l["txp.tag_id"]&&l["txp.tag_id"].length>0){const t=[];l["txp.tag_id"].forEach((r,o)=>{o===0?t.push(["txp.tag_id","=",r]):t.push("or",["txp.tag_id","=",r])}),e.push(t)}for(const t in l){if(!t.startsWith("attribute-")||l[t].length===0)continue;const[,r]=t.split("-"),o=[];l[t].forEach((F,z)=>{z===0?o.push(["apv.attribute_value_id","=",F]):o.push("or",["apv.attribute_value_id","=",F])}),e.push([["a.id","=",r],"and",o])}if(l.category_id&&l.category_id.length>0){const t=[];l.category_id.forEach((r,o)=>{o===0?t.push(["categoria_id","=",r]):t.push("or",["categoria_id","=",r])}),e.push(t)}if(l.subcategory_id&&l.subcategory_id.length>0){const t=[];l.subcategory_id.forEach((r,o)=>{o===0?t.push(["subcategory_id","=",r]):t.push("or",["subcategory_id","=",r])}),e.push(t)}try{const{status:t,data:r}=await b.post("/api/products/paginate",{requireTotalCount:!0,filter:H([...e,["products.visible","=",!0]],"and"),take:12,skip:12*(s-1)},{headers:{"Content-Type":"application/json"},cancelToken:x.current.token});N.current=(r==null?void 0:r.is_proveedor)??!1,M((r==null?void 0:r.data)??[]),T((r==null?void 0:r.totalCount)??0)}catch(t){b.isCancel(t)?console.log("Request canceled",t.message):console.error(t)}},j=S.reduce((e,t)=>(e[t.attribute_id]||(e[t.attribute_id]=[]),e[t.attribute_id].push(t),e),{}),h=g.find(e=>e.id===Number(n)),m=_.filter(e=>e.potition==="bottom"&&e.url_page==="catalogo"),u=_.filter(e=>e.potition==="mid"&&e.url_page==="catalogo");return a.createElement(a.Fragment,null,a.createElement("div",null,a.createElement("section",{className:"flex relative flex-col justify-center items-center px-[5%] pt-[136px] pb-[100px] text-base font-medium min-h-[345px] text-neutral-900"},a.createElement("img",{loading:"lazy",src:"/images/img/portada_fm.webp",alt:"",className:"object-cover absolute inset-0 size-full"}),a.createElement("div",{className:"flex relative flex-col max-w-full w-[499px] gap-10"},a.createElement("h2",{className:"mt-3 text-5xl text-center text-white max-md:max-w-full font-aeoniktrial_bold"},(h==null?void 0:h.name)??"Encuentra el Piso Perfecto para tu Auto"),a.createElement("div",{className:"flex flex-col items-center justify-center"},a.createElement("a",{href:"/catalogo",className:"bg-[#FF3D02] text-base font-medium text-white text-center font-aeoniktrial_regular px-6 py-2 rounded-lg flex items-center justify-center w-auto"},"Explorar Pisos para tu Auto")))),u.length>0&&a.createElement("div",{className:"flex flex-col md:flex-row justify-between bg-[#00152B] h-auto lg:h-[300px]"},a.createElement("div",{className:"w-full md:w-1/3 h-full"},u.map((e,t)=>a.createElement("img",{key:t,className:"object-contain object-left-top h-28 sm:h-full",src:e.image,alt:e.title}))),a.createElement("div",{className:"w-full md:w-2/3 flex flex-col items-start gap-8 justify-center py-10 px-[5%] lg:pl-[8%] "},a.createElement("h2",{className:"text-[#FF560A] text-3xl lg:text-4xl font-normal font-aeoniktrial_bold !leading-tight max-w-2xl"},u.map((e,t)=>a.createElement("span",{key:t},e.title))),a.createElement("h3",{className:"text-xl font-medium font-aeoniktrial_light text-white"},u.map((e,t)=>a.createElement("span",{key:t},e.description))),u.map((e,t)=>a.createElement("a",{key:t,href:e.url_btn,className:"bg-[#FF3D02] text-base font-medium text-white text-center font-aeoniktrial_regular px-6 py-2 rounded-lg flex items-center justify-center w-auto",type:"button"},e.title_btn)))),a.createElement("form",{className:"flex flex-col lg:flex-row gap-6  mx-auto font-Helvetica_Light font-bold w-full px-5 lg:px-10 py-10"},a.createElement("section",{className:"hidden lg:flex md:flex-col gap-4 md:basis-3/12 bg-white p-6 rounded-lg h-max top-2"},a.createElement(C,{setFilter:c,filter:l,minPrice:f??0,maxPrice:d??0,categories:g,tags:E,attribute_values:Object.values(j),selected_category:n,tag_id:y})),a.createElement("section",{className:"flex flex-col gap-6 md:basis-9/12"},a.createElement("div",{className:"w-full bg-white rounded-lg font-medium flex flex-row justify-between items-center px-2 py-3"},a.createElement("div",{className:"flex flex-col xl:flex-row  justify-start xl:justify-between items-start gap-2 "},a.createElement("span",{className:"font-normal text-[17px] text-[#666666] xl:ml-3"},"Mostrando ",(s-1)*12+1," - ",s*12>p?p:s*12," de ",p," resultados"),a.createElement("button",{type:"button",className:"lg:hidden text-[#006BF6]",onClick:()=>k(!0)}," Mostrar Filtros"))),a.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-3 gap-4 md:pr-4"},R.map((e,t)=>a.createElement(O,{key:`product-${e.id}`,item:e,bgcolor:"bg-white",is_reseller:N.current}))),a.createElement("div",{className:"w-full font-medium flex flex-row justify-center items-center"},a.createElement(D,{current:s,setCurrent:v,pages:Math.ceil(p/12)}))),B&&a.createElement("div",{className:"fixed z-40 top-0 left-0 w-full h-full bg-black bg-opacity-50 flex justify-center items-center max-h-[80vh] p-5",id:"modal"},a.createElement("div",{className:"z-50 flex items-center content-center justify-center absolute  p-4 bg-black rounded-full h-6 w-6",style:{top:"20px",right:"20px"}},a.createElement("button",{type:"button",onClick:()=>k(!1),className:"text-white text-md "},"X")),a.createElement("div",{className:"flex flex-col gap-4 w-full bg-white p-6 rounded-lg top-2 overflow-y-auto mt-10",style:{maxHeight:"90vh",maxWidth:"85vh"}},a.createElement(C,{setFilter:c,filter:l,minPrice:f??0,maxPrice:d??0,categories:g,tags:E,attribute_values:Object.values(j),selected_category:n,tag_id:y})))),m.length>0&&a.createElement("div",{className:"flex flex-col md:flex-row justify-between bg-[#00152B] h-auto lg:h-[300px]"},a.createElement("div",{className:"w-full md:w-1/3 h-full"},m.map((e,t)=>a.createElement("img",{key:t,className:"object-cover w-full h-full object-center sm:h-full",src:e.image,alt:e.title}))),a.createElement("div",{className:"w-full md:w-2/3 flex flex-col items-start gap-8 justify-center py-10 px-[5%] lg:pl-[8%] "},a.createElement("h2",{className:"text-[#FF560A] text-3xl lg:text-4xl font-normal font-aeoniktrial_bold !leading-tight max-w-2xl"},m.map((e,t)=>a.createElement("span",{key:t},e.title))),a.createElement("h3",{className:"text-xl font-medium font-aeoniktrial_light text-white"},m.map((e,t)=>a.createElement("span",{key:t},e.description))),m.map((e,t)=>a.createElement("a",{key:t,href:e.url_btn,className:"bg-[#FF3D02] text-base font-medium text-white text-center font-aeoniktrial_regular px-6 py-2 rounded-lg flex items-center justify-center w-auto",type:"button"},e.title_btn))))))};q((f,d)=>{A(f).render(a.createElement(L,{...d,activePage:"catalogo"}))});
